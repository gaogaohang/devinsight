# DevInsight å¼€å‘æ–‡æ¡£

## ğŸ“š æ–‡æ¡£å¯¼èˆª

### é˜¶æ®µæ–‡æ¡£
- [Phase 1: åŸºç¡€é¡¹ç›®æ­å»º](./phase-1-basic-setup.md)
- [Phase 2: ç”¨æˆ·ä¸é¡¹ç›®ç®¡ç†](./phase-2-user-project-management.md)

### å¿«é€Ÿé“¾æ¥
- [é¡¹ç›®æ¶æ„](#é¡¹ç›®æ¶æ„)
- [æŠ€æœ¯æ ˆ](#æŠ€æœ¯æ ˆ)
- [å¼€å‘ç¯å¢ƒ](#å¼€å‘ç¯å¢ƒ)
- [API æ–‡æ¡£](#api-æ–‡æ¡£)
- [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

---

## ğŸ—ï¸ é¡¹ç›®æ¶æ„

### æ•´ä½“æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          ç”¨æˆ· / å‰ç«¯åº”ç”¨                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      devinsight-backend                 â”‚
â”‚   (Java / Spring Boot)                  â”‚
â”‚                                         â”‚
â”‚  - ç”¨æˆ·è®¤è¯ & æˆæƒ                       â”‚
â”‚  - é¡¹ç›®ç®¡ç†                             â”‚
â”‚  - ä»»åŠ¡è°ƒåº¦                             â”‚
â”‚  - æƒé™æ§åˆ¶                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     devinsight-ai-core                  â”‚
â”‚   (Python / FastAPI)                    â”‚
â”‚                                         â”‚
â”‚  - å¤§æ¨¡å‹è°ƒç”¨                           â”‚
â”‚  - Prompt ç®¡ç†                          â”‚
â”‚  - å¼‚å¸¸åˆ†æ                             â”‚
â”‚  - ä»£ç å½±å“åˆ†æ                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

åŸºç¡€è®¾æ–½:
- PostgreSQL: æ ¸å¿ƒæ•°æ®å­˜å‚¨
- Redis: ç¼“å­˜ & é™æµ
- Docker: ç»Ÿä¸€éƒ¨ç½²
```

### Backend æ¨¡å—ç»“æ„

```
devinsight-backend/
â”œâ”€â”€ controller/          # API æ¥å£å±‚
â”œâ”€â”€ service/            # ä¸šåŠ¡é€»è¾‘å±‚
â”œâ”€â”€ mapper/             # æ•°æ®è®¿é—®å±‚ (MyBatis-Plus)
â”œâ”€â”€ entity/             # æ•°æ®åº“å®ä½“
â”œâ”€â”€ dto/                # è¯·æ±‚å‚æ•°å¯¹è±¡
â”œâ”€â”€ vo/                 # å“åº”æ•°æ®å¯¹è±¡
â”œâ”€â”€ config/             # é…ç½®ç±»
â”œâ”€â”€ interceptor/        # æ‹¦æˆªå™¨
â”œâ”€â”€ util/               # å·¥å…·ç±»
â””â”€â”€ exception/          # å¼‚å¸¸å¤„ç†
```

---

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

### Backend (devinsight-backend)

| æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| Java | 17 | å¼€å‘è¯­è¨€ |
| Spring Boot | 3.3.0 | åº”ç”¨æ¡†æ¶ |
| Spring Security | 3.3.0 | å®‰å…¨æ¡†æ¶ |
| MyBatis-Plus | 3.5.5 | ORM æ¡†æ¶ |
| PostgreSQL | 15 | å…³ç³»å‹æ•°æ®åº“ |
| JJWT | 0.12.5 | JWT Token |
| Lombok | - | ä»£ç ç®€åŒ– |
| Maven | - | æ„å»ºå·¥å…· |

### AI Core (devinsight-ai-core) - å¾…å¼€å‘
- Python 3.11+
- FastAPI
- LangChain
- OpenAI SDK

### åŸºç¡€è®¾æ–½
- Docker / Docker Compose
- PostgreSQL 15
- Redis 6

---

## ğŸ’» å¼€å‘ç¯å¢ƒ

### å¿…éœ€è½¯ä»¶
```bash
# Java
java -version  # è¦æ±‚ 17+

# Maven
mvn -version   # è¦æ±‚ 3.6+

# Docker
docker --version

# PostgreSQL (Docker)
docker ps | grep postgres
```

### ç¯å¢ƒå˜é‡
```bash
# æ•°æ®åº“
export DB_HOST=localhost
export DB_PORT=5432
export DB_NAME=devinsight
export DB_USER=devinsight_user
export DB_PASSWORD=devinsight123

# JWT
export JWT_SECRET=your-secret-key
export JWT_EXPIRATION=86400000
```

### IDE é…ç½®
**æ¨è**: IntelliJ IDEA Ultimate

é…ç½®æ­¥éª¤ï¼š
1. å®‰è£… Lombok æ’ä»¶
2. å¯ç”¨ Annotation Processing
3. é…ç½® JDK 17
4. å¯¼å…¥ Maven é¡¹ç›®

---

## ğŸ“¡ API æ–‡æ¡£

### Base URL
```
http://localhost:8080
```

### è®¤è¯æ–¹å¼
é™¤ä»¥ä¸‹æ¥å£å¤–ï¼Œæ‰€æœ‰ `/api/**` æ¥å£éƒ½éœ€è¦åœ¨ Header ä¸­æºå¸¦ JWT Tokenï¼š
```
Authorization: Bearer <your-jwt-token>
```

### ç™½åå•æ¥å£
- `GET /health` - å¥åº·æ£€æŸ¥
- `POST /api/auth/register` - ç”¨æˆ·æ³¨å†Œ
- `POST /api/auth/login` - ç”¨æˆ·ç™»å½•

### å®Œæ•´ API åˆ—è¡¨

#### è®¤è¯æ¨¡å—
| æ¥å£ | æ–¹æ³• | è¯´æ˜ | æ–‡æ¡£ |
|------|------|------|------|
| /api/auth/register | POST | ç”¨æˆ·æ³¨å†Œ | [æŸ¥çœ‹](./phase-2-user-project-management.md#1-ç”¨æˆ·æ³¨å†Œ) |
| /api/auth/login | POST | ç”¨æˆ·ç™»å½• | [æŸ¥çœ‹](./phase-2-user-project-management.md#2-ç”¨æˆ·ç™»å½•) |

#### ç”¨æˆ·æ¨¡å—
| æ¥å£ | æ–¹æ³• | è¯´æ˜ | æ–‡æ¡£ |
|------|------|------|------|
| /api/users/me | GET | è·å–å½“å‰ç”¨æˆ· | [æŸ¥çœ‹](./phase-2-user-project-management.md#3-è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯) |

#### é¡¹ç›®æ¨¡å—
| æ¥å£ | æ–¹æ³• | è¯´æ˜ | æ–‡æ¡£ |
|------|------|------|------|
| /api/projects | POST | åˆ›å»ºé¡¹ç›® | [æŸ¥çœ‹](./phase-2-user-project-management.md#4-åˆ›å»ºé¡¹ç›®) |
| /api/projects | GET | æˆ‘çš„é¡¹ç›®åˆ—è¡¨ | [æŸ¥çœ‹](./phase-2-user-project-management.md#5-è·å–æˆ‘çš„é¡¹ç›®åˆ—è¡¨) |
| /api/projects/{id} | GET | é¡¹ç›®è¯¦æƒ… | [æŸ¥çœ‹](./phase-2-user-project-management.md#6-è·å–é¡¹ç›®è¯¦æƒ…) |
| /api/projects/{id} | PUT | æ›´æ–°é¡¹ç›® | [æŸ¥çœ‹](./phase-2-user-project-management.md#7-æ›´æ–°é¡¹ç›®) |
| /api/projects/{id} | DELETE | åˆ é™¤é¡¹ç›® | [æŸ¥çœ‹](./phase-2-user-project-management.md#8-åˆ é™¤é¡¹ç›®) |

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å¯åŠ¨æ•°æ®åº“
```bash
# å¯åŠ¨ PostgreSQL å®¹å™¨
docker start docker-db-1

# éªŒè¯è¿æ¥
docker exec docker-db-1 psql -U devinsight_user -d devinsight -c "SELECT version();"
```

### 2. å¯åŠ¨ Backend æœåŠ¡

#### æ–¹å¼ä¸€ï¼šIDEAï¼ˆæ¨èï¼‰
1. æ‰“å¼€ `devinsight-backend` é¡¹ç›®
2. è¿è¡Œ `DevinsightBackendApplication.java`

#### æ–¹å¼äºŒï¼šå‘½ä»¤è¡Œ
```bash
cd devinsight-backend
mvn spring-boot:run
```

### 3. æµ‹è¯•æœåŠ¡
```bash
# å¥åº·æ£€æŸ¥
curl http://localhost:8080/health

# è¿è¡Œå®Œæ•´æµ‹è¯•
cd /Users/gh/devinsight
./test-api.sh
```

---

## ğŸ§ª æµ‹è¯•

### è‡ªåŠ¨åŒ–æµ‹è¯•
```bash
# å®Œæ•´æµç¨‹æµ‹è¯•
./test-api.sh

# å•ç‹¬æµ‹è¯•å¥åº·æ£€æŸ¥
curl http://localhost:8080/health
```

### æµ‹è¯•æ•°æ®
æµ‹è¯•è„šæœ¬ä¼šè‡ªåŠ¨åˆ›å»ºä»¥ä¸‹æ•°æ®ï¼š
- ç”¨æˆ·: `testuser` / `123456`
- é‚®ç®±: `test@example.com`
- é¡¹ç›®: `AIå¼‚å¸¸åˆ†æ`

### æ•°æ®åº“æŸ¥è¯¢
```bash
# è¿›å…¥æ•°æ®åº“
docker exec -it docker-db-1 psql -U devinsight_user -d devinsight

# æŸ¥çœ‹ç”¨æˆ·
SELECT * FROM "user";

# æŸ¥çœ‹é¡¹ç›®
SELECT * FROM project;

# æŸ¥çœ‹æˆå‘˜å…³ç³»
SELECT * FROM project_member;
```

---

## ğŸ“‹ å¸¸è§é—®é¢˜

### 1. æ•°æ®åº“è¿æ¥å¤±è´¥
**é—®é¢˜**: `Connection refused` æˆ– `database does not exist`

**è§£å†³**:
```bash
# æ£€æŸ¥å®¹å™¨çŠ¶æ€
docker ps | grep postgres

# é‡å¯å®¹å™¨
docker start docker-db-1

# æ£€æŸ¥æ•°æ®åº“
docker exec docker-db-1 psql -U postgres -c "\l"
```

### 2. JWT Token æ— æ•ˆ
**é—®é¢˜**: æ¥å£è¿”å› 401 `è®¤è¯ä»¤ç‰Œæ— æ•ˆæˆ–å·²è¿‡æœŸ`

**è§£å†³**:
- æ£€æŸ¥ Token æ˜¯å¦æºå¸¦åœ¨ Header ä¸­
- æ£€æŸ¥æ ¼å¼: `Authorization: Bearer <token>`
- Token æœ‰æ•ˆæœŸä¸º 24 å°æ—¶ï¼Œè¿‡æœŸéœ€é‡æ–°ç™»å½•
- æ£€æŸ¥ `application.yml` ä¸­çš„ `jwt.secret` æ˜¯å¦ä¸€è‡´

### 3. Maven ä¾èµ–ä¸‹è½½æ…¢
**é—®é¢˜**: MyBatis-Plus æˆ–å…¶ä»–ä¾èµ–ä¸‹è½½ç¼“æ…¢

**è§£å†³**:
```bash
# é…ç½®é˜¿é‡Œäº‘é•œåƒ
vim ~/.m2/settings.xml

# æ·»åŠ  mirror é…ç½®
<mirror>
  <id>aliyun</id>
  <mirrorOf>central</mirrorOf>
  <url>https://maven.aliyun.com/repository/public</url>
</mirror>
```

### 4. Lombok ä¸ç”Ÿæ•ˆ
**é—®é¢˜**: IDEA æç¤ºæ‰¾ä¸åˆ° getter/setter

**è§£å†³**:
1. å®‰è£… Lombok æ’ä»¶
2. Settings â†’ Build â†’ Compiler â†’ Annotation Processors
3. å‹¾é€‰ "Enable annotation processing"
4. Rebuild Project

### 5. ç«¯å£ 8080 è¢«å ç”¨
**é—®é¢˜**: `Port 8080 is already in use`

**è§£å†³**:
```bash
# æŸ¥æ‰¾å ç”¨è¿›ç¨‹
lsof -i :8080

# ä¿®æ”¹ç«¯å£ï¼ˆapplication.ymlï¼‰
server:
  port: 8081
```

---

## ğŸ“Š æ•°æ®åº“è®¾è®¡

### ER å›¾
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    User     â”‚
â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚ id (PK)     â”‚
â”‚ username    â”‚
â”‚ password    â”‚
â”‚ email       â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚ 1
       â”‚
       â”‚ N
â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Project   â”‚          â”‚ProjectMember â”‚
â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚          â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚ id (PK)     â”‚ 1     N  â”‚ id (PK)      â”‚
â”‚ name        â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ project_id   â”‚
â”‚ description â”‚          â”‚ user_id      â”‚
â”‚ owner_id(FK)â”‚          â”‚ role         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### è¡¨è¯´æ˜
è¯¦è§ [Phase 2 æ–‡æ¡£](./phase-2-user-project-management.md#1-æ ¸å¿ƒå®ä½“)

---

## ğŸ” å®‰å…¨è€ƒè™‘

### å¯†ç å®‰å…¨
- âœ… ä½¿ç”¨ BCrypt åŠ å¯†ï¼ˆæˆæœ¬å› å­ 10ï¼‰
- âœ… åŸå§‹å¯†ç ä¸å­˜å‚¨
- âœ… æ ¡éªŒæ—¶ä½¿ç”¨æ’å®šæ—¶é—´æ¯”è¾ƒ

### Token å®‰å…¨
- âœ… JWT ä½¿ç”¨ HMAC-SHA256 ç­¾å
- âœ… Token åŒ…å«è¿‡æœŸæ—¶é—´
- âœ… Secret ä¸ç¡¬ç¼–ç ï¼ˆé…ç½®æ–‡ä»¶ï¼‰

### API å®‰å…¨
- âœ… å…¨å±€å¼‚å¸¸å¤„ç†ï¼ˆä¸æš´éœ²æ•æ„Ÿä¿¡æ¯ï¼‰
- âœ… å‚æ•°æ ¡éªŒï¼ˆ@Validï¼‰
- âœ… SQL æ³¨å…¥é˜²æŠ¤ï¼ˆMyBatis-Plusï¼‰

### ç”Ÿäº§ç¯å¢ƒå»ºè®®
- ğŸ”„ ä¿®æ”¹ JWT Secret ä¸ºå¼ºéšæœºå­—ç¬¦ä¸²
- ğŸ”„ å¯ç”¨ HTTPS
- ğŸ”„ é…ç½® CORS ç™½åå•
- ğŸ”„ å¯ç”¨è¯·æ±‚é™æµ
- ğŸ”„ æ—¥å¿—è„±æ•

---

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–

### æ•°æ®åº“ä¼˜åŒ–
- âœ… å·²æ·»åŠ å¿…è¦ç´¢å¼•
- ğŸ”„ è€ƒè™‘åˆ†é¡µæŸ¥è¯¢ï¼ˆå¤§æ•°æ®é‡æ—¶ï¼‰
- ğŸ”„ æ…¢æŸ¥è¯¢æ—¥å¿—ç›‘æ§

### åº”ç”¨ä¼˜åŒ–
- ğŸ”„ Redis ç¼“å­˜ç”¨æˆ·ä¿¡æ¯
- ğŸ”„ è¿æ¥æ± é…ç½®
- ğŸ”„ å¼‚æ­¥ä»»åŠ¡å¤„ç†

---

## ğŸ”„ å¼€å‘æµç¨‹

### åˆ†æ”¯ç­–ç•¥
```
main        - ç”Ÿäº§ç¯å¢ƒ
develop     - å¼€å‘ç¯å¢ƒ
feature/*   - åŠŸèƒ½åˆ†æ”¯
hotfix/*    - ç´§æ€¥ä¿®å¤
```

### æäº¤è§„èŒƒ
```
feat: æ–°åŠŸèƒ½
fix: ä¿®å¤ bug
docs: æ–‡æ¡£æ›´æ–°
style: ä»£ç æ ¼å¼
refactor: é‡æ„
test: æµ‹è¯•
chore: æ„å»º/å·¥å…·
```

---

## ğŸ“ è”ç³»æ–¹å¼

**é¡¹ç›®è´Ÿè´£äºº**: [ä½ çš„åå­—]  
**é‚®ç®±**: [ä½ çš„é‚®ç®±]  
**GitHub**: [é¡¹ç›®åœ°å€]

---

**æœ€åæ›´æ–°**: 2026-02-01  
**å½“å‰ç‰ˆæœ¬**: v0.0.1-SNAPSHOT
